module Day1NotQuiteLisp
let dir = "((((()(()(((((((()))(((()((((()())(())()(((()((((((()((()(()(((()"+
            "(()((())))()((()()())))))))))()((((((())((()))(((((()(((((((((()"+
            "()))((()(())()((())((()(()))((()))()))()(((((()(((()()))()())((()"+
            "((((())()())()((((())()(()(()(((()(())(()(())(((((((())()()(((())"+
            "(()(()(()(())))(()((((())((()))(((()(()()(((((()()(()(((()(((((()"+
            ")()))()((()(()))()((()((((())((((())(()(((())()()(()()()()()(())("+
            "(((())((())(()()))()((((())))((((()())()((((())((()())((())(())(("+
            "(((()((((()(((()((((())(()(((()()))()))((((((()((())()())))(((()("+
            "()))(()()(()(((()(()))((()()()())((()()()(((())())()())())())((()"+
            "))(()(()))(((((()(()(())((()(())(())()((((()())()))((((())(())((("+
            "))())((((()(((())(())((()()((((()((((((()(())()()(()(()()((((()))"+
            "(())()())()))(())))(())))())()()(())(()))()((()(()(())()()))(()()"+
            ")))))(()))(()()))(())(((((()(()(()()((())()())))))((())())((())(("+
            ")(())((()))(())(((()((((((((()()()(()))()()(((()))()((()()(())(()"+
            ")())()(()(())))(((((()(())(())(()))))())()))(()))()(()(((((((()(("+
            "((())))())())())())()((((((((((((((()()((((((()()()())())()())())"+
            "())(())(())))())((()())((()(()))))))()))))))))))))))))())((())((("+
            "))()()))))))(((()((()(()()))((())(()()))()()())))(())))))))(()((("+
            "())))())()())))()()(())()))()(()))())((()()))))(()))))()))(()()(("+
            "))))))))()(((()))))()(()))(())())))))()))((()))((()))())(())))))))"+
            "))((((())()))()))()))())(())()()(())))())))(()())()))((()()(())))("+
            "())((((((()(())((()(((()(()()(())))()))))))()))()(()((()))()(()))("+
            "()(((())((((())())(())(()))))))))())))))))())())))))())))))()()(((("+
            "))()(()))))))))())))))(())()()()))()))()))(()(())()()())())))))))()"+
            ")()(()(()))))()()()))))())(()))))()()))))()())))))(((())()()))(()))"+
            "))))))))()()))))()()()))))(()())())()()())()(()))))()(()))(()))))))"+
            ")(((((())(())())()()))()()))(())))))()(()))))(())(()()))()())()))()"+
            "))()))()))))())()()))())())))(()))(()))))))())()(((())()))))))))()))"+
            "()())))())))())))()))))))))))()()))(()()))))))(())()(()))))())(())))"+
            ")(()))))(()())))))())())()()))))())()))))))))(()))))()))))))()(()())"+
            "))))))()))())))())))())))())))))))())(()()))))))(()())())))()())())))"+
            ")))))))))))())))()(())))()))())()()(())(()()))(())))())()())(()(()(()"+
            "))))())))))))))))())(()))()))()))))(())()())()())))))))))))()()))))))"+
            "))))))())())))))(()())))))))))))())(())))()))))))))())())(()))()))(("+
            "))))()))()()(())()))))))()((((())()))())())))))()))()))))((()())()))"+
            "))())))(())))))))))))))))))()))))()()())()))()()))))())()))((()())))"+
            "())))(()))(()())))))))()))()))))(())))))))(())))))())()()(()))())())"+
            ")()()))))())()()))))())()))())))))))(()))))()())()))))))))(()))())))"+
            "(()))()))))(())()))())())(())())())))))))((((())))))()))()))()())()("+
            "())))()))()))()())(()())()()(()())()))))())())))))(()))()))))())(()("+
            ")(())))))(())()()((())())))))(())(())))))))())))))))))()(())))))))()())())())()(()))))))))(()))))))))())()()))()(()))))))())"+
            ")))))())))))))(())))()()(())()())))))(((())))()((())()))())))(()()))())(())())))()(((()())))))()(()()())))()()(()()(()()))())"+
            "()(()()()))())()()))()())(()))))())))))())))(())()()))))(()))))(())(()))(())))))()()))()))))())()))()()(())())))((()))())())"+
            ")))))()()))))((()(()))))()()))))))())))))())(()((()())))))))))))()())())))()))(()))))))(()))(())()())))(()))))))))())()()()("+
            ")))))(()())))))))((())))()))(()))(())(())()())()))))))))(())))())))(()))()()))(()()))(()))())))()(())))())((()((()(())))((()"+
            ")))()))))((((())())()())))(())))()))))))())(()()((())))())()(()())))))(()())()))())))))))((())())))))))(()(()))())()()(()()("+
            "((()(((()())))))()))))))()(())(()()((()()(())()()))())()())()))()())())())))))))(((())))))))()()))))))(((())()))(()()))(()()"+
            "))))(()(()()((((())()())((()()))))(()(())))))()((()()()())()()((()((()()))(()))(((()()()))(((())))()(((())()))))))((()(())()"+
            ")))(()())(((((()(()))(()((()))(()())()))))(()(()))()(()))(())(((())(()()))))()()))(((()))))(()()()()))())))((()()()(())()))("+
            ")))))()()))()))))))((((((()()()))))())((()()(((()))))(()(())(()()())())())))()(((()()))(())((())))(()))(()()()())((())())())"+
            "(()))))()))()((()(())()(()()(())(()))(())()))(())(()))))(())(())())(()()(()((()()((())))((()))()((())))(((()()()()((((()))(("+
            ")()))()()()(((())((())())(()()(()()()))()((())(())()))())(((()()(())))()((()()())()())(()(())())(((())(())())((())(())()(((("+
            ")()))(())))((())(()())())(())((()()()((((((())))((()(((((())()))()))(())(()()))()))(())()()))(())((()()())()()(()))())()((()"+
            ")))()((()()())((((()())((())())())((()((()))()))((())((()()(()((()()(((())(()()))))((()((())()(((())(()((())())((())(()((((("+
            "(())())()(()())()(())(((())((((((()(())(()((()()()((()()(()()()())))()()(((((()()))()((((((()))()(()(()(()(((()())((()))())("+
            ")((()))(())))()))()()))())()()))())((((())(()(()))(((((((())(((()(((((()(((()()((((())(((())())))(()()()(()(()))()))((((((()"+
            "))((()(((()(())((()((((()((((((())(((((())))(((()(()))))(((()(((())()((())(()((()))(((()()(((())((((()(()(((((()))(((()((((("+
            "((()(()()()(()(()(()()())(())(((((()(())())()())(()(()(()))()(()()()())(()()(()((()))()((())())()(()))((())(()))()(()))()((("+
            "()(()(()((((((()()()()())()(((((()()(((()()()((()(((((()))((((((((()()()(((((()))))))(()()()(())(()))(()()))))(())()))(((((("+
            ")(((((()()(()(()())(((()))((((()((()(()(()((()(()((())))()(((()((()))((()))(((((((((()((()((()(())))()((((()((()()))((())((("+
            "()(((((()()(()(()()((()(()()()(((((((())())()())))))((((()()(()))()))(()((())()(()(((((((((()()(((()(()())(()((()())((())())"+
            "((((()(((()(((()((((()((()((((()(()((((((())((((((((((((()()(()()((((((((((((((()((()()))()((((((((((((())((((()(()())((()(("+
            ")(()))()(((((()()(((()()))()())(())((()(((((()((())(((((()((()(((((()))()()((((())()((((())(((((((((()(())(()(())))())(()((("+
            "))(((())(())(())())(()(()(())()()((()((())()(((()(((((()(())))()(((()((())))((()()()(((()(((()((()(()(())(()((()())(()(()((("+
            "()(((((((((())(()((((()()))(()((((()()()()(((()((((((((()(()()((((((()(()()(()((()((((((((((()()(((((((()())(())))(((()()))("+
            "((((()((()()())(()()((((())((()((((()))))(())((()(()()(((()(()(((()((((()(((((()))())())(()((())()))(((()())((())((())((((()"+
            "((()((((((())(()((((()()))((((((())()(()))((()(((())((((((((((()()(((((()(((((()((()()()((((())))(()))()((()(())()()((()(((("+
            "((((((()((())(())(((((()(()(()()))((((()((((()()((()(((()(((((((((()(()((()((()))((((((()(((())()()((()(((((((()())))()()(()"+
            "((()((()()(((()(()()()()((((()((())((((()(((((((((()(((()()(((()(()(((()(((()((())()(()((()(()(()(()))()(((()))(()((((()((()"+
            ")((((())((((((())(()))(()((((())((()(()((((((((()()((((((()(()(()()()(())((()((()()(((()(((((((()()((()(((((((()))(((((()((("+
            "()(()()()(()(((()((()()((())(()(((((((((()(()((()((((((()()((())()))(((((()((())()())()(((((((((((()))((((()()()()())(()()(("+
            ")(()()))()))(()))(()(((()()))())(()(()))()()((())(()())()())()(()))()))(()()(()((((((())((()(((((((((((()(())()((()(()((()(("+
            "()(()((()((((((((((()()())((())()(())))((())()())()(((((()(()())((((()((()(())(()))(((())()((()))(((((())(()))()()(()))(((()"+
            ")((((()((((()(())))(((((((()))))())()())(())((())()(()()((()(()))()(()()(()()((()())((())((()()))((((()))()()))(()()(())()()"+
            "(((((()(())((()((((()))()))(()())())(((()()(()()))(())))))(()))((())(((((()((((()))()((((()))()((())(((())))(((()())))((()(("+
            ")()(("
let findFloor directions= 
    
    let newBasementPosition characterIndex basementPosition floor = 
        if basementPosition = 0 && floor = -1 then characterIndex else basementPosition
    let rec findFloorRec (directions:string) floor basementPosition currentPosition= 
        let inc = 1
        let newPosition = newBasementPosition currentPosition basementPosition floor
        if directions.Length = 0 then (floor,newPosition) else 
        match (directions.Chars 0) with 
            | '(' -> findFloorRec (directions.Substring(1)) (floor + inc) newPosition (currentPosition + 1)
            | ')' -> findFloorRec (directions.Substring(1)) (floor - inc) newPosition (currentPosition + 1)
            | _ -> findFloorRec (directions.Substring(1)) floor newPosition (currentPosition + 1)
    findFloorRec directions 0 0 0

let map = findFloor dir